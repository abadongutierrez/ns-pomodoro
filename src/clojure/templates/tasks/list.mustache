{{> inner-header}}

<div class="container-fluid">
    <div class="title row">{{title}}</div>

<div id="div-new-task" class="row">
    <div class="col-md-12">
        <form class="form-inline" role="form" action="/tasks" method="POST">
            <div class="form-group">
                <input type="text" class="form-control" name="name" placeholder="Enter Task Name">
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-default">Add</button>
            </div>
        </form>
    </div>
</div>

<div class="row">
    <ul class="list-group task-list">
    {{#tasks}}
        <li class="list-group-item">
            <div class="task">
                <h4 class="list-group-item-heading">{{name}} <small>{{entered_date}}</small></h4>
                <div class="task-actions right">
                    <form id="tasks-form-{{task_id}}" style="display: inline;">
                        <div class="btn-group"> 
                            <button type="button" class="btn btn-default btn-lg btn-xs" onclick="markTaskAsDone({{task_id}});">
                                <span class="glyphicon glyphicon-unchecked"></span> Done
                            </button>
                            <button type="button" class="btn btn-default btn-xs" onclick="goToPomodorosPage({{task_id}});">
                                <span class="glyphicon glyphicon-time"></span> New Pomodoro
                            </button>    
                        </div>
                    </form>
                    <!-- TODO define CSS for this -->
                    <form action="/tasks/{{task_id}}" method="DELETE" style="display: inline;">
                        <div class="btn-group" style="float: right!important">
                            <button type="submit" class="btn btn-default btn-xs btn-danger">
                                <span class="glyphicon glyphicon-remove"></span>
                            </button>                  
                        </div>
                    </form>
                </div>
            </div>
        </li>
    {{/tasks}}
    </ul>
</div>

<script type="text/javascript">
function goToPomodorosPage(taskId) {
    var id = '#tasks-form-' + taskId;
    $(id).attr('action', '/tasks/' + taskId + '/pomodoros');
    $(id).attr('method', 'POST');
    $(id).submit();
}

function markTaskAsDone(taskId) {
    var id = '#tasks-form-' + taskId;
    $(id).attr('action', '/tasks/' + taskId + '/done');
    $(id).attr('method', 'POST');
    $(id).submit();
}
</script>

{{> inner-footer}}